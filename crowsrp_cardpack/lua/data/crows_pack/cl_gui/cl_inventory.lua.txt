-- lua/crows_cards/cl_gui/cl_inventory.lua

surface.CreateFont("CrowsCardFont", {
    font = "Roboto Bold",
    size = 24,
    weight = 600
})

local PANEL = {}

function PANEL:Init()
    self:SetSize(ScrW() * 0.8, ScrH() * 0.8)
    self:Center()
    self:SetTitle("Crows RP - Card Inventory")
    self:MakePopup()

    self.SearchBar = self:Add("DTextEntry")
    self.SearchBar:Dock(TOP)
    self.SearchBar:SetPlaceholderText("Search by name or rarity...")

    self.CardScroll = self:Add("DScrollPanel")
    self.CardScroll:Dock(FILL)

    self:ReloadCards()
end

function PANEL:ReloadCards()
    self.CardScroll:Clear()

    for _, card in pairs(LocalPlayer().CrowsInventory or {}) do
        local cardPanel = self.CardScroll:Add("DPanel")
        cardPanel:Dock(TOP)
        cardPanel:SetTall(150)
        cardPanel:DockMargin(5, 5, 5, 5)
        cardPanel.Paint = function(s, w, h)
            draw.RoundedBox(8, 0, 0, w, h, Color(30, 30, 30, 200))
            draw.SimpleText(card.name or "Unnamed Card", "CrowsCardFont", 10, 10, Color(255, 255, 255), TEXT_ALIGN_LEFT)
            draw.SimpleText("Rarity: " .. (card.rarity_name or "?"), "CrowsCardFont", 10, 40, Color(200, 200, 200))
        end

        local EquipButton = cardPanel:Add("DButton")
        EquipButton:SetText(card.equipped and "Unequip" or "Equip")
        EquipButton:SetSize(100, 30)
        EquipButton:SetPos(10, 100)
        EquipButton.DoClick = function()
            net.Start("CrowsTCG:ToggleEquip")
                net.WriteTable(card)
            net.SendToServer()
        end
    end
end

vgui.Register("CrowsCardInventory", PANEL, "DFrame")

concommand.Add("!unboxcards", function()
    vgui.Create("CrowsCardInventory")
end)
